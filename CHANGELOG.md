# CHANGELOG

---

## 26-май-2025 23:20

### Добавлено

- **Реализована функция выравнивания изображений с текстом:**
  - Внедрен алгоритм трансформации на основе сетки координат
  - Реализовано применение cv2.remap для выпрямления изображений
  - Добавлены индикаторы загрузки во время обработки изображения

### Улучшено

- **Код реорганизован для большей модульности:**
  - Создан отдельный модуль grid_utils.py в core/ для операций с сеткой
  - Функции создания, нормализации и визуализации сетки вынесены в отдельный файл
  - Улучшена читаемость кода в view_page.py
  
- **Улучшен пользовательский интерфейс:**
  - Добавлены анимации загрузки во время обработки изображений
  - Поэтапное обновление UI при длительных операциях
  - Переработан процесс визуализации обработки

### Изменено

- Обновлены скриншоты в документации, отражающие новый функционал
- Обновлен README.md с учетом новых возможностей

---

## 25-май-2025 23:25

### Добавлено

- **Функционал сохранения изображений:**
  - Создан модуль `image_processor.py` в директории `ui/utils/`
  - Отредактирован код в main_page.py, некоторая логика вынесена в отдельный файлы в `ui/handlers` и `ui/components`

### Улучшено

- **Структура проекта:**
  - Обновлена документация в README.md с учетом новых компонентов
  - Улучшена организация обработчиков (хендлеров) и других логик работы приложения

### Изменено
- **Структура проекта**:
 - Удалены временные решения в виде добавлнения вотремарки на изображение
 - Подгтовка проекта к внедрению возможности выпрямления изображения

---

## 18-май-2025 21:35

### Новое

- **Добавлен режим автоматической обработки:**
  - Реализовано переключение между ручным (Hand) и автоматическим (Auto) режимами работы через вкладки в верхней части интерфейса
  - Создана заготовка для страницы автоматического режима (`ui/auto_page.py`)
  - Автоматический режим пока находится в разработке

### Изменено

- **Переработана структура интерфейса:**
  - Добавлена верхняя панель с выбором режима работы (Hand/Auto)
  - В ручном режиме добавлены вкладки "Ввод границ" и "Выравнивание" для удобного переключения между этапами работы
  - Улучшено визуальное представление координат точек

### Улучшено

- **Обновлена документация:**
  - README.md дополнен описанием новых режимов и обновленного интерфейса
  - Обновлена структура проекта с учетом добавления нового файла auto_page.py
  - Расширен раздел "Пример сценария использования" с учетом новой структуры интерфейса

---

## 12-май-2025 16:15

### Изменено

- README.md полностью обновлён:
  - Подробно описана структура всех подпапок ui (components, handlers, state, utils), их назначение и связи.
  - Добавлена схема взаимодействия компонентов.
  - Приведён подробный пример сценария использования с пояснениями к скриншотам.
  - Уточнено, что запускать нужно app.py.
- requirements.txt приведён в соответствие с актуальными зависимостями (flet, opencv-python, numpy, scipy).

### Улучшено

- Модульная структура UI:
  - components: отдельные визуальные элементы (image_display, control_panel и др.)
  - handlers: обработчики событий (image_handlers, grid_handlers)
  - state: хранение и управление состоянием (AppState)
  - utils: вспомогательные функции для UI
- Описаны связи между компонентами и их взаимодействие через AppState и обработчики.
- Улучшено обновление и отображение сетки при добавлении точек и построении сетки.

---

## 11-май-2025 21:45

### Исправлено

- Устранён баг со смещённым отображением сетки в режиме просмотра:
  - Убран padding, который уменьшал область для ввода точек
  - Теперь сетка корректно отображается на изображении в режиме просмотра

### Добавлено

- **Сохранение и загрузка точек границ:**
  - Добавлена возможность сохранения точек в JSON-файл
  - Реализована загрузка точек из JSON-файла
  - Формат JSON включает:
    - Координаты точек для каждой границы
    - Путь к исходному изображению
    - Временную метку сохранения

### Улучшено

- **Работа с координатами:**
  - Добавлен автоматический перевод локальных координат ввода в масштаб загруженного изображения
  - В интерфейсе отображаются локальные координаты
  - При сохранении используются координаты в масштабе исходного изображения

---

## 11-май-2025 18:30

### Изменено

- **Реорганизация структуры проекта:**
  - Разделение `main.py` на три отдельных файла:
    - `app.py` - основной файл приложения
    - `ui/main_page.py` - страница ввода точек
    - `ui/view_page.py` - страница просмотра
  - Создание модульной структуры с разделением логики и представления
  - Обновление путей импорта и зависимостей

### Технические улучшения

- Улучшена организация кода для лучшей поддерживаемости
- Обновлена документация в соответствии с новой структурой

---

## 09-май-2025 18:15

### Новое

- Добавлен функционал для автоматического добавления водяного знака "CHANGED IMAGE" на изображение в правой панели режима просмотра.
- Реализована возможность отображения/скрытия сетки с помощью чекбокса.
- Добавлен полноценный режим просмотра с двумя панелями: оригинальное изображение с наложенной сеткой и изображение с водяным знаком.

### Изменено

- Добавлена навигация между режимами с сохранением состояния.

### Технические улучшения

- Добавлена обработка ошибок при построении сетки и загрузке изображений.

### Планы

- Реализовать возможность удаления отдельных точек.
- Добавить алгоритм выпрямления текста на основе построенной сетки.

---

## 09-май-2025 12:30

### Исправлено

- Устранён баг с возможностью ввода точек вне области изображения.
- Улучшено отображение изображений в обеих панелях для более корректного позиционирования элементов.

---

## 07-май-2025 18:30

### Новое

- Реализовано построение криволинейной сетки по введённым граничным точкам (отображается на второй панели).
- Вторая панель теперь отображает не только точки, но и построенную сетку поверх изображения.

### Изменено

- README.md обновлён: отражены новые возможности, уточнено назначение второй панели.

### Планы

- Добавить возможность удаления отдельных введённых точек.
- Использовать вторую панель для отображения исправленного (выпрямлённого) изображения.

---

## 05-май-2025 13:00

### Изменено и добавлено

- **Интерфейс переработан для работы с граничными точками:**
  - Вместо цветов теперь используются четыре границы: **Верхняя, Нижняя, Левая, Правая**.
  - Для выбора текущей границы добавлено выпадающее меню с подписями.
  - Над выпадающим меню отображается текст "Текущая граница:".
- **Левая панель:**
  - Кнопки "Загрузить изображение" и "Очистить точки" размещены вертикально справа от выпадающего меню.
  - При клике по изображению добавляются точки выбранной границы.
  - Координаты точек для каждой границы отображаются в отдельном блоке.
- **Правая панель:**
  - Кнопка "Построить криволинейную сетку" теперь расположена под заголовком.
  - После нажатия этой кнопки на дублированном изображении отображаются все введённые точки.
- **Цвета точек для границ:**  
  - Верхняя — красный  
  - Нижняя — синий  
  - Левая — зелёный  
  - Правая — оранжевый
- **Адаптивность:**  
  Интерфейс масштабируется при изменении размера окна.
- **README.md полностью обновлён:**
  - Добавлено описание нового интерфейса и функционала.
  - Включён скриншот интерфейса.
  - Описаны ограничения web-режима и планы по развитию.

---
